2026-01-21 13:17:08 - __main__ - INFO - Cleared old file: C:\Users\Lenovo\Documents\traffic-marl\outputs\metrics.csv
2026-01-21 13:17:08 - __main__ - INFO - Cleared old file: C:\Users\Lenovo\Documents\traffic-marl\outputs\summary.txt
2026-01-21 13:17:08 - __main__ - INFO - Cleared old file: C:\Users\Lenovo\Documents\traffic-marl\outputs\policy_final.pth
2026-01-21 13:17:08 - __main__ - INFO - \U0001f504 Starting with completely fresh training state - all old files cleared
2026-01-21 13:17:08 - __main__ - INFO - Using GNN-DQN: forcing neighbor_obs=False to let graph networks learn spatial patterns
2026-01-21 13:17:08 - src.env - INFO - Grid topology initialized: 3x4 grid for 10 intersections
2026-01-21 13:17:08 - __main__ - INFO - \U0001f504 Environment initialized with fresh state
2026-01-21 13:17:08 - __main__ - INFO - \u26a0\ufe0f  GPU not available, using CPU (training will be slower)
2026-01-21 13:17:08 - __main__ - INFO - Using GNN-DQN architecture with 8 node features - FRESH INITIALIZATION
2026-01-21 13:17:08 - __main__ - INFO - Target network initialized with fresh model weights
2026-01-21 13:17:08 - __main__ - INFO - Initialized fresh replay buffer with capacity 50000
2026-01-21 13:17:09 - __main__ - INFO - Initialized fresh optimizer with learning rate 0.001
2026-01-21 13:17:09 - __main__ - INFO - Starting GNN-DQN Shared-Policy Multi-Agent RL Training:
2026-01-21 13:17:09 - __main__ - INFO - - 10 intersections (shared policy, not independent agents)
2026-01-21 13:17:09 - __main__ - INFO - - 50 episodes
2026-01-21 13:17:09 - __main__ - INFO - - 300 steps per episode (~600s)
2026-01-21 13:17:09 - __main__ - INFO - - Learning rate: 0.001
2026-01-21 13:17:09 - __main__ - INFO - - Model: GNN-DQN
2026-01-21 13:17:09 - __main__ - INFO - \U0001f504 GUARANTEED FRESH START: All old files cleared, models initialized fresh, no old data loaded
2026-01-21 13:17:09 - __main__ - INFO - - Epsilon decay: 1.0 -> 0.01 over 5000 steps
GNN-DQN Multi-Agent Episodes:   0%|          | 0/50 [00:00<?, ?it/s]2026-01-21 13:17:16 - __main__ - INFO - Ep  1/50: eps=1.000 | Queue=3.25 | Throughput=1722 | TravelTime=13.1s | Loss=1.2078 | Updates=251
GNN-DQN Multi-Agent Episodes:   2%|2         | 1/50 [00:07<05:46,  7.06s/it]2026-01-21 13:17:23 - __main__ - INFO - Ep  2/50: eps=1.000 | Queue=3.77 | Throughput=1807 | TravelTime=14.3s | Loss=1.2123 | Updates=300
GNN-DQN Multi-Agent Episodes:   4%|4         | 2/50 [00:13<05:26,  6.81s/it]2026-01-21 13:17:29 - __main__ - INFO - Ep  3/50: eps=1.000 | Queue=3.66 | Throughput=1842 | TravelTime=13.7s | Loss=1.2493 | Updates=300
GNN-DQN Multi-Agent Episodes:   6%|6         | 3/50 [00:20<05:13,  6.68s/it]2026-01-21 13:17:36 - __main__ - INFO - Ep  4/50: eps=1.000 | Queue=3.60 | Throughput=1837 | TravelTime=13.5s | Loss=1.1975 | Updates=300
GNN-DQN Multi-Agent Episodes:   8%|8         | 4/50 [00:26<05:01,  6.56s/it]2026-01-21 13:17:42 - __main__ - INFO - Ep  5/50: eps=1.000 | Queue=3.10 | Throughput=1739 | TravelTime=12.3s | Loss=1.2354 | Updates=300
GNN-DQN Multi-Agent Episodes:  10%|#         | 5/50 [00:32<04:49,  6.43s/it]2026-01-21 13:17:48 - __main__ - INFO - Ep  6/50: eps=1.000 | Queue=3.49 | Throughput=1762 | TravelTime=13.8s | Loss=1.3767 | Updates=300
GNN-DQN Multi-Agent Episodes:  12%|#2        | 6/50 [00:39<04:42,  6.43s/it]2026-01-21 13:17:55 - __main__ - INFO - Ep  7/50: eps=1.000 | Queue=3.42 | Throughput=1821 | TravelTime=13.1s | Loss=1.4647 | Updates=300
GNN-DQN Multi-Agent Episodes:  14%|#4        | 7/50 [00:45<04:31,  6.32s/it]2026-01-21 13:18:01 - __main__ - INFO - Ep  8/50: eps=1.000 | Queue=3.80 | Throughput=1753 | TravelTime=14.8s | Loss=1.6050 | Updates=300
GNN-DQN Multi-Agent Episodes:  16%|#6        | 8/50 [00:51<04:23,  6.28s/it]2026-01-21 13:18:07 - __main__ - INFO - Ep  9/50: eps=1.000 | Queue=3.28 | Throughput=1822 | TravelTime=12.6s | Loss=1.8013 | Updates=300
GNN-DQN Multi-Agent Episodes:  18%|#8        | 9/50 [00:58<04:22,  6.39s/it]2026-01-21 13:18:13 - __main__ - INFO - Ep 10/50: eps=1.000 | Queue=3.70 | Throughput=1803 | TravelTime=14.2s | Loss=1.8829 | Updates=300
GNN-DQN Multi-Agent Episodes:  20%|##        | 10/50 [01:04<04:12,  6.30s/it]2026-01-21 13:18:20 - __main__ - INFO - Ep 11/50: eps=1.000 | Queue=3.62 | Throughput=1738 | TravelTime=14.2s | Loss=1.8706 | Updates=300
GNN-DQN Multi-Agent Episodes:  22%|##2       | 11/50 [01:10<04:03,  6.25s/it]2026-01-21 13:18:26 - __main__ - INFO - Ep 12/50: eps=0.955 | Queue=3.57 | Throughput=1694 | TravelTime=14.1s | Loss=1.8635 | Updates=300
GNN-DQN Multi-Agent Episodes:  24%|##4       | 12/50 [01:16<03:54,  6.18s/it]2026-01-21 13:18:32 - __main__ - INFO - Ep 13/50: eps=0.901 | Queue=3.35 | Throughput=1755 | TravelTime=13.2s | Loss=2.0864 | Updates=300
GNN-DQN Multi-Agent Episodes:  26%|##6       | 13/50 [01:22<03:47,  6.15s/it]2026-01-21 13:18:38 - __main__ - INFO - Ep 14/50: eps=0.847 | Queue=3.90 | Throughput=1776 | TravelTime=15.0s | Loss=2.3222 | Updates=300
GNN-DQN Multi-Agent Episodes:  28%|##8       | 14/50 [01:28<03:41,  6.15s/it]2026-01-21 13:18:44 - __main__ - INFO - Ep 15/50: eps=0.793 | Queue=3.21 | Throughput=1725 | TravelTime=12.9s | Loss=2.9346 | Updates=300
GNN-DQN Multi-Agent Episodes:  30%|###       | 15/50 [01:34<03:35,  6.16s/it]2026-01-21 13:18:50 - __main__ - INFO - Ep 16/50: eps=0.739 | Queue=3.56 | Throughput=1789 | TravelTime=13.8s | Loss=2.4449 | Updates=300
GNN-DQN Multi-Agent Episodes:  32%|###2      | 16/50 [01:41<03:30,  6.19s/it]2026-01-21 13:18:57 - __main__ - INFO - Ep 17/50: eps=0.685 | Queue=3.18 | Throughput=1834 | TravelTime=12.3s | Loss=2.7729 | Updates=300
GNN-DQN Multi-Agent Episodes:  34%|###4      | 17/50 [01:47<03:26,  6.26s/it]2026-01-21 13:19:03 - __main__ - INFO - Ep 18/50: eps=0.631 | Queue=3.48 | Throughput=1778 | TravelTime=13.7s | Loss=2.6456 | Updates=300
GNN-DQN Multi-Agent Episodes:  36%|###6      | 18/50 [01:54<03:23,  6.37s/it]2026-01-21 13:19:10 - __main__ - INFO - Ep 19/50: eps=0.577 | Queue=3.75 | Throughput=1849 | TravelTime=14.0s | Loss=2.5841 | Updates=300
GNN-DQN Multi-Agent Episodes:  38%|###8      | 19/50 [02:01<03:23,  6.56s/it]2026-01-21 13:19:18 - __main__ - INFO - Ep 20/50: eps=0.523 | Queue=3.03 | Throughput=1750 | TravelTime=12.3s | Loss=2.6962 | Updates=300
GNN-DQN Multi-Agent Episodes:  40%|####      | 20/50 [02:09<03:29,  6.97s/it]2026-01-21 13:19:26 - __main__ - INFO - Ep 21/50: eps=0.469 | Queue=3.08 | Throughput=1771 | TravelTime=12.2s | Loss=2.4232 | Updates=300
GNN-DQN Multi-Agent Episodes:  42%|####2     | 21/50 [02:16<03:28,  7.19s/it]2026-01-21 13:19:33 - __main__ - INFO - Ep 22/50: eps=0.415 | Queue=3.70 | Throughput=1793 | TravelTime=14.1s | Loss=2.3610 | Updates=300
GNN-DQN Multi-Agent Episodes:  44%|####4     | 22/50 [02:23<03:21,  7.18s/it]2026-01-21 13:19:41 - __main__ - INFO - Ep 23/50: eps=0.361 | Queue=3.37 | Throughput=1778 | TravelTime=13.3s | Loss=2.1756 | Updates=300
GNN-DQN Multi-Agent Episodes:  46%|####6     | 23/50 [02:31<03:15,  7.25s/it]2026-01-21 13:19:48 - __main__ - INFO - Ep 24/50: eps=0.307 | Queue=3.39 | Throughput=1798 | TravelTime=13.1s | Loss=2.0327 | Updates=300
GNN-DQN Multi-Agent Episodes:  48%|####8     | 24/50 [02:38<03:09,  7.31s/it]2026-01-21 13:19:55 - __main__ - INFO - Ep 25/50: eps=0.253 | Queue=4.31 | Throughput=1762 | TravelTime=16.4s | Loss=2.1260 | Updates=300
GNN-DQN Multi-Agent Episodes:  50%|#####     | 25/50 [02:46<03:03,  7.32s/it]2026-01-21 13:20:03 - __main__ - INFO - Ep 26/50: eps=0.199 | Queue=3.04 | Throughput=1718 | TravelTime=12.3s | Loss=1.9946 | Updates=300
GNN-DQN Multi-Agent Episodes:  52%|#####2    | 26/50 [02:53<02:56,  7.34s/it]2026-01-21 13:20:10 - __main__ - INFO - Ep 27/50: eps=0.145 | Queue=3.66 | Throughput=1794 | TravelTime=14.0s | Loss=2.1645 | Updates=300
GNN-DQN Multi-Agent Episodes:  54%|#####4    | 27/50 [03:00<02:48,  7.34s/it]2026-01-21 13:20:17 - __main__ - INFO - Ep 28/50: eps=0.099 | Queue=3.54 | Throughput=1732 | TravelTime=14.0s | Loss=1.9012 | Updates=300
GNN-DQN Multi-Agent Episodes:  56%|#####6    | 28/50 [03:08<02:41,  7.34s/it]2026-01-21 13:20:25 - __main__ - INFO - Ep 29/50: eps=0.094 | Queue=3.88 | Throughput=1782 | TravelTime=14.8s | Loss=1.5708 | Updates=300
GNN-DQN Multi-Agent Episodes:  58%|#####8    | 29/50 [03:15<02:34,  7.35s/it]2026-01-21 13:20:32 - __main__ - INFO - Ep 30/50: eps=0.088 | Queue=3.51 | Throughput=1767 | TravelTime=13.8s | Loss=1.6762 | Updates=300
GNN-DQN Multi-Agent Episodes:  60%|######    | 30/50 [03:22<02:27,  7.37s/it]2026-01-21 13:20:40 - __main__ - INFO - Ep 31/50: eps=0.083 | Queue=3.57 | Throughput=1771 | TravelTime=13.7s | Loss=1.5019 | Updates=300
GNN-DQN Multi-Agent Episodes:  62%|######2   | 31/50 [03:30<02:19,  7.36s/it]2026-01-21 13:20:47 - __main__ - INFO - Ep 32/50: eps=0.077 | Queue=3.42 | Throughput=1669 | TravelTime=13.9s | Loss=1.3516 | Updates=300
GNN-DQN Multi-Agent Episodes:  64%|######4   | 32/50 [03:37<02:12,  7.36s/it]2026-01-21 13:20:54 - __main__ - INFO - Ep 33/50: eps=0.072 | Queue=3.40 | Throughput=1742 | TravelTime=13.5s | Loss=1.2968 | Updates=300
GNN-DQN Multi-Agent Episodes:  66%|######6   | 33/50 [03:45<02:05,  7.37s/it]2026-01-21 13:21:02 - __main__ - INFO - Ep 34/50: eps=0.067 | Queue=3.52 | Throughput=1704 | TravelTime=14.1s | Loss=1.3553 | Updates=300
GNN-DQN Multi-Agent Episodes:  68%|######8   | 34/50 [03:52<01:58,  7.38s/it]2026-01-21 13:21:09 - __main__ - INFO - Ep 35/50: eps=0.061 | Queue=3.34 | Throughput=1727 | TravelTime=13.4s | Loss=1.4552 | Updates=300
GNN-DQN Multi-Agent Episodes:  70%|#######   | 35/50 [03:59<01:50,  7.39s/it]2026-01-21 13:21:17 - __main__ - INFO - Ep 36/50: eps=0.056 | Queue=3.91 | Throughput=1793 | TravelTime=14.9s | Loss=1.3964 | Updates=300
GNN-DQN Multi-Agent Episodes:  72%|#######2  | 36/50 [04:07<01:43,  7.39s/it]2026-01-21 13:21:24 - __main__ - INFO - Ep 37/50: eps=0.050 | Queue=3.64 | Throughput=1759 | TravelTime=14.1s | Loss=1.4807 | Updates=300
GNN-DQN Multi-Agent Episodes:  74%|#######4  | 37/50 [04:14<01:36,  7.40s/it]2026-01-21 13:21:31 - __main__ - INFO - Ep 38/50: eps=0.045 | Queue=3.53 | Throughput=1786 | TravelTime=13.6s | Loss=1.3023 | Updates=300
GNN-DQN Multi-Agent Episodes:  76%|#######6  | 38/50 [04:22<01:28,  7.42s/it]2026-01-21 13:21:39 - __main__ - INFO - Ep 39/50: eps=0.040 | Queue=3.89 | Throughput=1762 | TravelTime=14.8s | Loss=2.0625 | Updates=300
GNN-DQN Multi-Agent Episodes:  78%|#######8  | 39/50 [04:29<01:21,  7.45s/it]2026-01-21 13:21:46 - __main__ - INFO - Ep 40/50: eps=0.034 | Queue=3.87 | Throughput=1736 | TravelTime=14.9s | Loss=1.6484 | Updates=300
GNN-DQN Multi-Agent Episodes:  80%|########  | 40/50 [04:37<01:14,  7.44s/it]2026-01-21 13:21:54 - __main__ - INFO - Ep 41/50: eps=0.029 | Queue=3.82 | Throughput=1745 | TravelTime=14.9s | Loss=1.7940 | Updates=300
GNN-DQN Multi-Agent Episodes:  82%|########2 | 41/50 [04:44<01:06,  7.44s/it]2026-01-21 13:22:01 - __main__ - INFO - Ep 42/50: eps=0.023 | Queue=3.96 | Throughput=1741 | TravelTime=15.4s | Loss=1.1806 | Updates=300
GNN-DQN Multi-Agent Episodes:  84%|########4 | 42/50 [04:51<00:59,  7.44s/it]2026-01-21 13:22:09 - __main__ - INFO - Ep 43/50: eps=0.018 | Queue=3.42 | Throughput=1647 | TravelTime=14.0s | Loss=1.3931 | Updates=300
GNN-DQN Multi-Agent Episodes:  86%|########6 | 43/50 [04:59<00:52,  7.46s/it]2026-01-21 13:22:16 - __main__ - INFO - Ep 44/50: eps=0.013 | Queue=4.14 | Throughput=1761 | TravelTime=15.8s | Loss=1.8144 | Updates=300
GNN-DQN Multi-Agent Episodes:  88%|########8 | 44/50 [05:07<00:44,  7.49s/it]2026-01-21 13:22:24 - __main__ - INFO - Ep 45/50: eps=0.010 | Queue=3.57 | Throughput=1718 | TravelTime=14.2s | Loss=1.2649 | Updates=300
GNN-DQN Multi-Agent Episodes:  90%|######### | 45/50 [05:14<00:37,  7.49s/it]2026-01-21 13:22:31 - __main__ - INFO - Ep 46/50: eps=0.010 | Queue=3.80 | Throughput=1705 | TravelTime=15.0s | Loss=1.7082 | Updates=300
GNN-DQN Multi-Agent Episodes:  92%|#########2| 46/50 [05:21<00:29,  7.47s/it]2026-01-21 13:22:39 - __main__ - INFO - Ep 47/50: eps=0.010 | Queue=4.27 | Throughput=1806 | TravelTime=15.9s | Loss=1.5756 | Updates=300
GNN-DQN Multi-Agent Episodes:  94%|#########3| 47/50 [05:29<00:22,  7.52s/it]2026-01-21 13:22:46 - __main__ - INFO - Ep 48/50: eps=0.010 | Queue=4.08 | Throughput=1771 | TravelTime=15.5s | Loss=2.6219 | Updates=300
GNN-DQN Multi-Agent Episodes:  96%|#########6| 48/50 [05:37<00:15,  7.53s/it]2026-01-21 13:22:54 - __main__ - INFO - Ep 49/50: eps=0.010 | Queue=3.85 | Throughput=1666 | TravelTime=15.4s | Loss=1.6317 | Updates=300
GNN-DQN Multi-Agent Episodes:  98%|#########8| 49/50 [05:44<00:07,  7.50s/it]2026-01-21 13:23:01 - __main__ - INFO - Ep 50/50: eps=0.010 | Queue=4.30 | Throughput=1764 | TravelTime=16.2s | Loss=2.3587 | Updates=300
GNN-DQN Multi-Agent Episodes: 100%|##########| 50/50 [05:52<00:00,  7.54s/it]GNN-DQN Multi-Agent Episodes: 100%|##########| 50/50 [05:52<00:00,  7.04s/it]
2026-01-21 13:23:01 - __main__ - INFO - Saved final GNN-DQN policy to C:\Users\Lenovo\Documents\traffic-marl\outputs\policy_final.pth
2026-01-21 13:23:01 - __main__ - INFO - Wrote final summary to C:\Users\Lenovo\Documents\traffic-marl\outputs\final_report.json
